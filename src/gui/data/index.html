<!doctype html>
<html>
    <head>
            <style>
                .wrapper {
                    width: 170px; /* Set the size of the progress bar */
                    height: 170px;
                    position: absolute; /* Enable clipping */
                    clip: rect(0px, 150px, 150px, 75px); /* Hide half of the progress bar */
                    }
                    /* Set the sizes of the elements that make up the progress bar */
                .circle {
                    width: 130px;
                    height: 130px;
                    border: 10px solid #88C057;
                    border-radius: 93px;
                    position: absolute;
                    clip: rect(0px, 75px, 150px, 0px);
                    transition: transform  0.3s;
                    transform: rotate(0deg);
                    }
            </style>
            <style>
                body{
                    background: #2F374A;
                    width: 300px;
                    font-family: Arial, Helvetica, sans-serif;
                    font-size: 12px;
                    text-align: center;
                    padding-top: 30px;
                    color:#e0e0e0;
                    cursor:default;
                    -webkit-touch-callout: none; /* iOS Safari */
                    -webkit-user-select: none; /* Safari */
                    -khtml-user-select: none; /* Konqueror HTML */
                    -moz-user-select: none; /* Firefox */
                        -ms-user-select: none; /* Internet Explorer/Edge */
                            user-select: none; /* Non-prefixed version, currently
                                                supported by Chrome and Opera */
                }
                
                #choose{
                    float:right
                }
                
                .form{
                    padding-top: 10px;
                }
                
                .progress_container{
                    width: 150px;
                    margin: auto;
                    height: 150px;
                    /* background: red; */
                }

                
                #progress_pointer{
                    float: right;
                    font-size: 25px;
                    color:#ffffff;
                    font-weight: 700;
                    position: relative;
                    top:60px;
                    width:120px;
                    text-align: center;
                    right:15px;
                }
                
                .now_file{
                  color:#c4c4c4;
                  float: left; 
                }
                
                .form_buttons{
                    padding-top: 30px;
                    
                    margin: auto;
                    width: 200px;

                }
                .choosen_directory{
                    float: left;
                }
                
                .animate
                {
                    transition: all 0.1s;
                    -webkit-transition: all 0.1s;
                }
                .action_button{
                    cursor: pointer;
                    width:max-content;
                    display: inline;
                    user-select: none;
                    text-decoration: none;
                }
                .action_button:hover{
                    color: red;
                }
                .form_select{
                    color:#ffffff9d;
                    margin-top: 20px;
                }
                #select_ip{
                    width: 120px;
                    border-radius: 2.5px;
                    background: #c4c4c4;
                    margin-left: 10px;
                }
                
                #begin{
                    /* opacity: 0.3; */
                    margin-top: 20px;
                    
                }
                #begin_svg,
                #stop_svg,
                #break_svg{
                    display: inline-block;
                    width: 50px;
                    height: 50px;
                    margin:auto;
                    pointer-events: none;
                }
                .image_button{
                    width: 50px;
                    height: 50px;

                }
                #stop_svg,
                #break_svg{
                    display: none;
                }
                .active_button{
                    transition: all 0.1s ease-in-out;
                    cursor: pointer;
                    opacity: 0.9;
                    pointer-events: none;
                    height: 30px;
                    width: 30px;
                }
                .active_button:hover{
                    opacity: 1
                }
                .active_button:active{
                    box-shadow: none;
                    opacity: 0.7
                }
                #alert{
                    color:red;
                    text-align: center;
                    height: 15px;
                    margin-top: 10px;
                }
                .log{
                    max-height: 40px;
                    text-align: left;
                    width:200px;
                    margin:auto;
                    opacity: 0.3;
                    overflow: hidden;
                }
                </style>
    </head>
    <body>
           
            <div>Your IP: <span id="myIP">127.0.0.1</span></div>
            <div class="progress_container">
                    <div class="wrapper" data-anim="base wrapper" id="wrapper">
                            <div class="circle" data-anim="base left" id="circle_left"></div>
                            <div class="circle" data-anim="base right" id="circle_right"></div>
                     </div>
                     <div id="progress_pointer">
                         0%
                     </div>
                      
                
            </div>
            <div class="form_buttons">
                    <div class="choosen_directory">
                         Directory: <span id='choosen_directory'>none</span>
                    </div>
                    <div type="button" id="choose" class="action_button">
                            Choose!
                    </div>
                    
                </div>
    
                <div class='form'>
                        <div class="form_select">
                                <span>Receiver IP: </span>       
                                <select id="select_ip">
                                   <option value="127.0.0.1">127.0.0.1</option>    
                                </select>
                        </div>
            
            <div id="alert"></div>
            </div>
            <div  id="begin">
                <div id="begin_svg" onclick="startLoad()" title="Start or continue">
                    <svg class="active_button" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 232.153 232.153" style="enable-background:new 0 0 232.153 232.153;" xml:space="preserve" width="512px" height="512px">
                        <g id="Play">
                            <path style="fill-rule:evenodd;clip-rule:evenodd;" d="M203.791,99.628L49.307,2.294c-4.567-2.719-10.238-2.266-14.521-2.266   c-17.132,0-17.056,13.227-17.056,16.578v198.94c0,2.833-0.075,16.579,17.056,16.579c4.283,0,9.955,0.451,14.521-2.267   l154.483-97.333c12.68-7.545,10.489-16.449,10.489-16.449S216.471,107.172,203.791,99.628z" fill="#FFFFFF"/>
                        </g>
                    </svg> 
                </div>
                <div id="stop_svg" onclick="stopLoad()" title="Pause">
                    <svg  class="active_button" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 232.679 232.679" style="enable-background:new 0 0 232.679 232.679;" xml:space="preserve" width="512px" height="512px">
                        <g id="Pause">
                            <path style="fill-rule:evenodd;clip-rule:evenodd;" d="M80.543,0H35.797c-9.885,0-17.898,8.014-17.898,17.898v196.883   c0,9.885,8.013,17.898,17.898,17.898h44.746c9.885,0,17.898-8.013,17.898-17.898V17.898C98.44,8.014,90.427,0,80.543,0z M196.882,0   h-44.746c-9.886,0-17.899,8.014-17.899,17.898v196.883c0,9.885,8.013,17.898,17.899,17.898h44.746   c9.885,0,17.898-8.013,17.898-17.898V17.898C214.781,8.014,206.767,0,196.882,0z" fill="#FFFFFF"/>
                        </g>
                    </svg>
                </div>

                <div  id="break_svg" onclick="breakLoad()" title="Cancel upload">
                    <svg class="active_button" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 212.982 212.982" style="enable-background:new 0 0 212.982 212.982;" xml:space="preserve" width="512px" height="512px">
                        <g id="Close">
                            <path style="fill-rule:evenodd;clip-rule:evenodd;" d="M131.804,106.491l75.936-75.936c6.99-6.99,6.99-18.323,0-25.312   c-6.99-6.99-18.322-6.99-25.312,0l-75.937,75.937L30.554,5.242c-6.99-6.99-18.322-6.99-25.312,0c-6.989,6.99-6.989,18.323,0,25.312   l75.937,75.936L5.242,182.427c-6.989,6.99-6.989,18.323,0,25.312c6.99,6.99,18.322,6.99,25.312,0l75.937-75.937l75.937,75.937   c6.989,6.99,18.322,6.99,25.312,0c6.99-6.99,6.99-18.322,0-25.312L131.804,106.491z" fill="#FFFFFF"/>
                        </g>
                    </svg>
                </div>
                  <div class="log" id="log"></div>      
                </div>
            <!-- <input id="files" type="file" webkitdirectory directory multiple/> -->
            <script>
                document.getElementById('choose').addEventListener("click", chooseFunc);
                // document.getElementById('begin_svg').addEventListener('click', start)
                window.external.invoke('myIP')

                window.transData = {path: "none"};
                var last_fin = 0;
                function startLoad(){
                    console.log("Hello")
                    if(window.transData.path=="none"){
                        document.getElementById("alert").innerHTML="Choose directory!!!"
                    }else{
                        document.getElementById("alert").innerHTML=""
                        document.getElementById("begin_svg").style.display = 'none'
                        document.getElementById("stop_svg").style.display = 'inline-block'
                        document.getElementById("break_svg").style.display = 'inline-block'
                    }
                }
                function stopLoad(){
                    document.getElementById("stop_svg").style.display = 'none'
                    document.getElementById("begin_svg").style.display = 'inline-block'

                }

                function breakLoad(){
                    document.getElementById("stop_svg").style.display = 'none'
                    document.getElementById("break_svg").style.display = 'none'
                    document.getElementById("begin_svg").style.display = 'inline-block'
                }
                

                function sleep (time, resolve) {
                    (function (resolve) {
                        setTimeout(function () { 
                            resolve();
                        },time)
                    })(resolve)
                }  

                function progress(val){
                    var fin = 3.6* val
                    if(fin>180){
                        document.getElementById("circle_left").style.transform = "rotate(180deg)"
                        document.getElementById("circle_right").style.transform = "rotate("+fin+"deg)"
                        
                        // bug with transitions
                        if(last_fin<=180){
                            sleep(300, function(){
                                document.getElementById("wrapper").style.clip="rect(auto,auto,auto,auto)" 
                            });
                        }
                        last_fin = fin;
                        
                    }else{
                        document.getElementById("wrapper").style.clip="rect(0px,150px,150px,75px)"
                        document.getElementById("circle_left").style.transform = "rotate("+fin+"deg)"
                        document.getElementById("circle_right").style.transform = "rotate(0deg)"
                        last_fin = fin;
                    }
                    document.getElementById('progress_pointer').innerHTML = event.target.value+"%"
                }

                function setMyIP(ip){
                    document.getElementById("myIP").innerHTML = ip
                }

                function setLog(log){
                    document.getElementById("log").innerHTML = log
                }
                
                function chooseFunc(){
                    window.external.invoke('opendir');
                    if(window.transData.path.length==0){
                        window.transData.path = "none"
                    }
                    var path =  window.transData.path
                    if(window.transData.path.length>=10){path = '...'+path.substr(path.length - 7)}
                    document.getElementById('choosen_directory').innerHTML = path;
                }

                function beginFunc(){
                    
                }


            </script>
    </body>
</html>